<style>
  .popup-module-diy {
 	padding: 80px 0;
	overflow: hidden;
 }

 .popup-module-diy .popup-module-title {
 	color: #1E1E1E;
 	text-align: center;
 	font-family: var(--heading-font-family);
 	font-size: 48px;
 	line-height: 1;
 }
.popup-module-diy .popup-module-cont{
	position: relative;
}
 .popup-module-diy .popup-module-list {
 	display: flex;
 	margin-top: 60px;
 }
 
 .popup-module-diy .popup-module-item{
	 width: calc(25% - 27px);
	 margin-right: 36px;
	 position: relative;
 }
 .popup-module-diy .popup-module-item:last-child{
	 margin-right: 0;
 }
  .popup-module-diy .popup-module-item::after{
	  position: absolute;
	  content: '';
	  display: block;
	  width: 100%;
	  height: 36%;
	  left: 0;
	  bottom: 0;
	  background: linear-gradient(180deg, rgba(0, 0, 0, 0.00) 0%, rgba(0, 0, 0, 0.90) 100%);
	  z-index: 2;
  }
 
 .popup-module-diy .popup-module-item img{
	 width: 100%;
	 display: block;
	 position: relative;
	 z-index: 1;
 }
  .popup-module-diy .hide-txt{
	display: none;
 }
 .popup-module-diy .popup-module-text{
	position: absolute;
	z-index: 3;
	width: 100%;
	left: 0;
	bottom: 28px;
	text-align: center;
 }
 
 .popup-module-diy .popup-module-p{
	 color: #FFF;
	 font-size: 20px;
 }
 
  .popup-module-diy .popup-module-sub{
	 color: #FFF;
	 font-family: var(--heading-font-family);
	 font-size: 36px;
	 line-height: 1;
 }
 
 .popup-module-diy .txt{
	 color: #FFF;
	 font-size: 16px;
	 opacity: 0;
	 transition: all .4s ease;
	 display: block;
	 position: relative;
	 z-index: 1;
	 margin-left: 30px;
 }
 
 .popup-module-diy .popup-module-btn{
	 position: relative;
	 margin-top: 18px;
	 cursor: pointer;
 }
 .popup-module-diy .popup-module-btn svg{
	 position: absolute;
	 top: 50%;
	 left: 50%;
	 transform: translate(-50%,-50%);
	 z-index: 2;
	 transition: all .5s ease;
 }
 
 .popup-module-diy .popup-module-item:hover .txt,.popup-module-diy .popup-module-item.active .txt{
	 opacity: 1;
 }
 .popup-module-diy .popup-module-item:hover svg,.popup-module-diy .popup-module-item.active svg{
	 transform: translate(-50%,-50%) rotate(1turn);
	 margin-left: -39px;
 }

  .popup-module-diy .popup-module-dot{
	 display: none;
	 justify-content: center;
	 margin-top: 18px;
 }
 .popup-module-diy .popup-module-dot-item{
	 width: 5px;
	 height: 5px;
	 background: #D9D9D9;
	 margin: 0 5px;
 }
 
 .popup-module-diy .popup-module-dot-item.active{
	background: #7A7A7A;
 }
 .popup-module-diy .popup-module-arrow{
	 display: none;
	 justify-content: space-between;
	 position: absolute;
	 top: 50%;
	 transform: translateY(-50%);
	 width: 325px;
	 left: -15px;
	 z-index: 3;
 }
  .popup-module-diy .popup-module-arrow-item{
	 cursor: pointer;
 }
  .popup-module-diy .popup-module-arrow-item:first-child {
	 transform: scale(-1,1);
	 opacity: 0;
 }
 
 .popup-module-diy .popup-box{
	 position: fixed;
	 width: 100%;
	 height: 100%;
	 background: rgba(0, 0, 0, 0.4);
	 top: 0;
	 left: 0;
	 z-index: 99;
	 overflow-y: auto;
	 display: none;
 }
  .popup-module-diy .popup-box-cont{
	  position: relative;
	  padding: 80px 0;
	  background: #fff;
	  width: 100%;
	  max-width: 1200px;
	  margin: 0 auto;
	  top: 50%;
	  transform: translateY(-50%);
	  height: calc(100vh - 80px );
      overflow: hidden;
  }
  .popup-module-diy .popup-box-text{
	  max-width: 800px;
	  margin: 0 auto;
	  display: flex;
	  flex-direction: column;
	  min-height: 100%;
  }
  .popup-module-diy .popup-box-text-cont{
    overflow-y: auto;
    height: 100%;
    width:calc(100% + 40px );
    padding-right:40px;
    
  }
  .popup-module-diy .popup-box-close{
	  position: absolute;
	  right: 30px;
	  top: 30px;
	  cursor: pointer;
	  width: 40px;
	  height: 40px;
	  display: flex;
	  align-items: center;
	  justify-content: center;
  }
  .popup-module-diy .popup-box-close svg{
	  width: 20px;
	  transition: all .8s ease;
  }
  
  .popup-module-diy .popup-box-close:hover svg{
	  transform: rotate(360deg);
  }
 
 .popup-module-diy .popup-img{
	 display: block;
	 margin: 0;
 }
 
  .popup-module-diy .popup-box-name{
	 color: #000;
	 font-size: 36px;
	 line-height: 1.1;
	 margin-top: 20px;
    font-family: var(--heading-font-family);
 }
 
.popup-module-diy .popup-box-p{
	 color: #000;
	 font-size: 16px;
	 line-height: 1.5;
	 margin-top: 20px;
	 flex: 1;
     padding-right:5px;
 }
 .popup-module-diy .popup-box-p strong{
   font-family: var(--heading-font-family);
   font-weight: normal;
 }
  .hide-box{
    overflow: hidden;
  }
/* @media (min-width:991px) { */
   .popup-module-diy .popup-box-text-cont::-webkit-scrollbar {
    width: 0px; 
  }
  
   .popup-module-diy .popup-box-text-cont::-webkit-scrollbar-track {
    background-color: #f1f1f1; 
  }
  
   .popup-module-diy .popup-box-text-cont::-webkit-scrollbar-thumb {
    background-color: #aaa;
  }
  
   .popup-module-diy .popup-box-text-cont::-webkit-scrollbar-thumb:hover {
    background-color: #555; 
  }
/* } */
 .popup-module-diy .video-el{
	 width: 100%;
 }
 .popup-module-diy .hide{
   display: none !important;
 }
 @media (max-width:1400px) {
	 .popup-module-diy .popup-module-sub{
		 font-size: 30px;
	 }
 	.popup-module-diy .popup-module-item{
		width: calc(25% - 15px);
		margin-right: 20px;
	}
	
 }
 
 @media (max-width:1200px) {
 	.popup-module-diy .popup-module-sub{
 		font-size: 25px;
 	}
 }
 
 @media (max-width:991px) {
   .popup-module-diy{
       padding:36px 0 60px 0;
   }
 	 .popup-module-diy .popup-module-title {
		 font-size: 28px;
		 line-height: 1.4;
	 }
	 .popup-module-diy .popup-module-list{
		 margin-top: 18px;
	 }
	 .popup-module-diy .txt{
		 font-size: 14px;
	 }
	 .popup-module-diy .popup-module-sub{
		 font-size: 28px;
	 }
	 .popup-module-diy .popup-module-item{
		 width: 276px;
		 flex-shrink: 0;
	 }
	 .popup-module-diy .popup-box-cont{
		 height: 100%;
		 padding: 50px 20px;
	 }
	 .popup-module-diy .popup-box-close{
		 top: 10px;
		 right: 10px;
		 height: 30px;
		 width: 30px;
	 }
	 .popup-module-diy .popup-module-arrow{
		 display: flex;
	 }
	 .popup-module-diy .popup-module-dot{
		 display: flex;
	 }
   .popup-module-diy .popup-module-item:hover svg{
     margin-left:-35px;
   }
   .popup-module-diy .txt{
     margin-left:24px;
   }
    .popup-module-diy .popup-box-name{
      font-size:28px;
      margin-top: 12px;
    }
   .popup-module-diy .popup-box-p{
     font-size:14px;
     margin-top:10px;
   }
 }
 
</style>
<section class="section-box">
  <div class="popup-module-diy">
    <div class="container">
      {%- if section.settings.title != blank -%}
          <div class="popup-module-title">{{ section.settings.title }}</div>
      {%- endif -%}
        
        <div class="popup-module-cont">
            <div class="popup-module-list">
              {%- for block in section.blocks -%}
                <div class="popup-module-item" data-video="{{ block.settings.video }}" data-mVideo="{{ block.settings.mobile_video }}">
                  {%- if block.settings.image != blank -%}
                       <img loading="lazy" width="{{ block.settings.image.width }}" height="{{ block.settings.image.height }}" {% render 'image-attributes', image: block.settings.image %} alt="{{ block.settings.image.alt | escape }}" >
                    {%- endif -%}
                    {%- if block.settings.P_image != blank -%}
                       <img loading="lazy" class="hide pc-img" width="{{ block.settings.P_image.width }}" height="{{ block.settings.P_image.height }}" {% render 'image-attributes', image: block.settings.P_image %} alt="{{ block.settings.P_image.alt | escape }}" >
                    {%- endif -%}
                    {%- if block.settings.m_image != blank -%}
                       <img loading="lazy" class="hide mb-img" width="{{ block.settings.m_image.width }}" height="{{ block.settings.m_image.height }}" {% render 'image-attributes', image: block.settings.m_image %} alt="{{ block.settings.m_image.alt | escape }}" >
                    {%- endif -%}
                    <div class="popup-module-text">
                        <div class="popup-module-p">{{ block.settings.title }}</div>
                        <div class="popup-module-sub">{{ block.settings.name }}</div>
                        <div class="popup-module-btn">
                          {%- if block.settings.video != blank -%}
                              <svg xmlns="http://www.w3.org/2000/svg" width="19" height="18" viewBox="0 0 19 18"
                                  fill="none">
                                  <circle cx="9.5" cy="9" r="9" fill="#57C8BA" />
                                  <path d="M14.5 9L7 13.3301L7 4.66987L14.5 9Z" fill="black" />
                              </svg>
                              {%- else -%}
                                <svg xmlns="http://www.w3.org/2000/svg" width="23" height="23" viewBox="0 0 23 23"
                                    fill="none">
                                    <circle cx="11.5" cy="11.5" r="11.5" fill="#57C8BA" />
                                    <rect x="11" y="17" width="11" height="1.04" transform="rotate(-90 11 17)"
                                        fill="black" />
                                    <rect x="6" y="11" width="11" height="1.04" fill="black" />
                                </svg>
                            {%- endif -%}
                            <span class="txt">{{ block.settings.sub }}</span>
                        </div>
                    </div>
                    <div class="hide-txt">
                      {{ block.settings.popup_txt }}
                    </div>
                </div>
               {%- endfor -%}
            </div>
            <div class="popup-module-arrow">
                <div class="popup-module-arrow-item">
                    <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30"
                        fill="none">
                        <circle cx="15" cy="15" r="15" fill="black" fill-opacity="0.5" />
                        <path d="M12.7251 9.02485L18.7003 15L12.7251 20.9751" stroke="white" stroke-width="2"
                            stroke-linecap="square" />
                    </svg>
                </div>
                <div class="popup-module-arrow-item">
                    <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30"
                        fill="none">
                        <circle cx="15" cy="15" r="15" fill="black" fill-opacity="0.5" />
                        <path d="M12.7251 9.02485L18.7003 15L12.7251 20.9751" stroke="white" stroke-width="2"
                            stroke-linecap="square" />
                    </svg>
                </div>
            </div>
        </div>
        <div class="popup-module-dot">
          {%- for block in section.blocks -%}
            <div class="popup-module-dot-item {% if forloop.index == 1 %}active{% endif %}"></div>
          {%- endfor -%}
        </div>
    </div>
    <div class="popup-box">
        <div class="popup-box-cont">
            <div class="popup-box-close">
                <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 25 25" fill="none">
                    <path
                        d="M0.784745 21.3978C-0.239783 22.337 -0.261127 23.2974 0.720712 24.2793C1.70255 25.2611 2.66303 25.2398 3.60218 24.2153L12.5 15.4455L21.3978 24.2153C22.337 25.2398 23.2974 25.2611 24.2793 24.2793C25.2611 23.2974 25.2398 22.337 24.2152 21.3978L15.4455 12.5L24.2152 3.60217C25.2398 2.66303 25.2611 1.70256 24.2793 0.720701C23.2974 -0.261132 22.337 -0.239775 21.3978 0.784748L12.5 9.5545L3.60218 0.784748C2.66303 -0.239775 1.70255 -0.261132 0.720712 0.720701C-0.261127 1.70256 -0.239783 2.66303 0.784745 3.60217L9.5545 12.5L0.784745 21.3978Z"
                        fill="black" />
                </svg>
            </div>
            <div class="popup-box-text-cont">
            <div class="popup-box-text">
                <img class="popup-img" src="" alt="" srcset="">
                <div class="video-box">
                    <video class="video-el" autoplay muted controls playsinline preload="metadata" src=""></video>
                </div>
                <div class="popup-box-name">Lauren</div>
                <div class="popup-box-p">

                </div>
            </div>
            </div>
        </div>
    </div>
</div>
</section>
<script>
   window.addEventListener('load', function() {
      $('html').on('click', '.popup-module-diy .popup-module-btn', function() {
          let $p = $(this).closest('.popup-module-diy')
          let $item = $(this).parents('.popup-module-item')
          let pcSrc = $item.find('.pc-img').attr('src')
          let mbSrc = $item.find('.mb-img').attr('src')
          let txt = $item.find('.hide-txt').html()
          let name = $item.find('.popup-module-sub').text()
          let videoSrc = $item.data('video')
          let videoSrcM = $item.data('mVideo')
          let $popup = $p.find('.popup-box')
          let winWidth = window.innerWidth
  
          if (videoSrc) {
              $popup.find('.video-el').attr('src', winWidth < 740 ? videoSrcM : videoSrc)
              $popup.find('.video-box').show()
              $popup.find('.popup-img').hide()
          } else {
              $popup.find('.popup-img').attr('src', winWidth < 740 ? mbSrc : pcSrc).show()
              $popup.find('.video-box').hide()
          }
  
          $popup.find('.popup-box-name').text(name)
          $popup.find('.popup-box-p').html(txt)
          $popup.fadeIn()
        $('body').addClass('hide-box')
      })
      $('html').on('click', '.popup-box .popup-box-close', function() {
          let $this = $(this)
          $this.closest('.popup-box').fadeOut()
          $('body').removeClass('hide-box')
          setTimeout(function() {
              $this.closest('.popup-box').find('.video-el').attr('src', '')
          }, 400);
      })
  
      function popupSlideDiy(name) {
          let $p = $(name)
          let $list = $p.find('.popup-module-list')
          let length = $list.find('.popup-module-item').length
          let index = 0
          let left = $list.offset().left
          let criticalIndex = length - 1
          let isLeft = false
          $p.find('.popup-module-arrow-item').click(function() {
              let sIndex = $(this).index()
              isLeft = sIndex
              index += sIndex ? 1 : -1
              if (index < 0) index = length - 1
              if (index == length) index = 0
              changeLeft()
          })
  
          $p.find('.popup-module-dot-item').click(function() {
              index = $(this).index()
              changeLeft()
          })
  
          function getTranslateX($element) {
              var matrix = $element.css('transform').replace(/[^0-9\-.,]/g, '').split(',');
              var translateX = parseFloat(matrix[12] || matrix[4]);
              return translateX;
          }
  
          function changeLeft() {
              let width = $list.find('.popup-module-item').width()
              let pWidth = (width + 20) * length - $p.width() + left
              let translateX = (width + 20) * index
  
              if (translateX >= pWidth) {
                  criticalIndex = index
                  translateX = pWidth
                  index = length - 1
              }
              if (getTranslateX($list) == pWidth && isLeft) {
                  index = criticalIndex
              }
              if (window.innerWidth <= 991) {
                  if (index == 0) {
                      $p.find('.popup-module-arrow-item:nth-child(1)').css({
                          'opacity': 0
                      })
                  } else {
                      $p.find('.popup-module-arrow-item:nth-child(1)').css({
                          'opacity': 1
                      })
                  }
              }
            // $list.find('.popup-module-item').eq(index).addclass('active').siblings().removeClass('active')
              $list.css({
                  'transform': 'translateX(-' + translateX + 'px)',
                  'transition': ' all .4s ease'
              })
              $p.find('.popup-module-dot-item').eq(index).addClass('active').siblings().removeClass('active')
          }
  
          function initMobileCarousel() {
              let startX = 0;
  
              $list.on('touchstart', function(e) {
                  var touch = e.originalEvent.touches[0] || e.originalEvent.changedTouches[0];
                  startX = touch.clientX;
              });
  
              $list.on('touchmove', function(e) {
                  var touch = e.originalEvent.touches[0] || e.originalEvent.changedTouches[0];
                  var diffX = touch.clientX - startX;
                  var translateX = -index * 100 + (diffX / window.innerWidth) * 100 + '%';
                  $list.css('transform', 'translateX(' + translateX + ')');
              });
  
              $list.on('touchend', function(e) {
                  var touch = e.originalEvent.touches[0] || e.originalEvent.changedTouches[0];
                  var diffX = touch.clientX - startX;
                  if (Math.abs(diffX) > window.innerWidth * 0.3) {
                      if (diffX > 0) {
                          index = Math.max(index - 1, 0);
                      } else {
                          index = Math.min(index + 1, length - 1);
                      }
                  }
                  changeLeft()
              });
          }
          initMobileCarousel()
  
          window.addEventListener('resize', function() {
              changeLeft()
          })
      }
      if (window.innerWidth < 991) {
          popupSlideDiy('.popup-module-diy')
      }
  })
</script>
{% schema %}
{
  "name": "popup-module",
  "class": "popup-module-box",
  "blocks": [
    {
      "name": "item",
      "type": "item",
      "settings": [
        {
          "type": "video",
          "id": "video",
          "label": "Video"
        },
         {
          "type": "video",
          "id": "mobile_video",
          "label": "Mobile Video"
        },
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "image_picker",
          "id": "P_image",
          "label": "Pc Popup Image"
        },
        {
          "type": "image_picker",
          "id": "m_image",
          "label": "Mobile Popup Image"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Heading"
        },
        {
          "type": "text",
          "id": "name",
          "label": "Name"
        },
        {
          "type": "text",
          "id": "sub",
          "label": "Hover Text"
        },
        {
          "type": "richtext",
          "id": "popup_txt",
          "label": "Popup Text"
        }
      ]
    }
  ],
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "Title"
    }
  ],
  "presets": [
    {
      "name": "popup-module",
      "blocks": []
    }
  ]
}
{% endschema %}
